# DIPLOMA  
## Перевірка прав та обробка помилок у Bash-скриптах  

Цей шаблон поєднує перевірку прав суперкористувача та обробку помилок в Bash-скриптах проєкту. Його мета — забезпечити надійне, передбачуване та безпечне виконання скриптів, які потребують привілеїв root, з чіткою діагностикою помилок.  

───────────────────────────────  
🔹 Призначення  
───────────────────────────────  

У Bash за замовчуванням виконання скриптів без необхідних прав може призвести до збоїв, а помилки можуть залишатись непоміченими. Для уникнення цих проблем використовується комбінація перевірки прав та обробки помилок:  

```
#!/usr/bin/env bash  
set -euo pipefail  

# Перевірка прав на виконання  
if [ "$(id -u)" -ne 0 ]; then  
  echo  
  echo "ВІДМОВА! Недостатньо прав!"  
  echo  
  exit 1  
fi  

# Обробка помилок  
trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR  
```

───────────────────────────────  
🔹 Пояснення  
───────────────────────────────  

- ```#!/usr/bin/env bash```  
  Використовує Bash незалежно від його розташування у системі.  

- ```set -euo pipefail```  
  - -e: Завершити при першій помилці.  
  - -u: Заборонити необ’явлені змінні.  
  - -o pipefail: Помилка в конвеєрі = помилка всього блоку.  

- ```if [ "$(id -u)" -ne 0 ]; then ...```  
  Перевіряє, чи є користувач суперкористувачем (UID = 0). Якщо ні, виводить повідомлення про недостатність прав і завершує скрипт.  

- ```trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR```  
  Виводить повідомлення про помилку з номером рядка та завершує скрипт.  

───────────────────────────────  
🔹 Приклад  
───────────────────────────────  

```
#!/usr/bin/env bash  
set -euo pipefail  

# Перевірка прав на виконання  
if [ "$(id -u)" -ne 0 ]; then  
  echo  
  echo "ВІДМОВА! Недостатньо прав!"  
  echo  
  exit 1  
fi  

# Обробка помилок  
trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR  

# Операції, що потребують прав root  
mkdir -p /root/test  
cp /неіснуючий_файл.txt /root/test/  
```

→ Вивід, якщо скрипт виконано без прав root:  
```
ВІДМОВА! Недостатньо прав!
```

→ Вивід при помилці (з правами root):  
```
Сталася помилка на рядку 14
```

───────────────────────────────  
✅ Переваги  
───────────────────────────────  

✓ Уніфікована поведінка скриптів  
✓ Гарантія виконання лише з необхідними правами  
✓ Швидке виявлення помилок із зазначенням номера рядка  
✓ Безпечна робота з конвеєрами та змінними  
✓ Проста діагностика та відповідність best practices  

───────────────────────────────  
📌 Примітка  
───────────────────────────────  

Цей шаблон рекомендовано додавати до всіх Bash-скриптів проєкту, які потребують прав суперкористувача, для забезпечення безпеки, надійності та чіткої діагностики виконання.
