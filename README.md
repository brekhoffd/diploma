# DIPLOMA  
## Обробка помилок в Bash-скриптах  

Цей шаблон обробки помилок використовується у всіх Bash-скриптах проєкту. Його мета — зробити виконання скриптів надійними, передбачуваними та безпечними незалежно від їх функціоналу.  

───────────────────────────────  
🔹 Призначення  
───────────────────────────────  

У Bash за замовчуванням багато помилок залишаються непоміченими. Щоб цього уникнути, у кожному скрипті використовується така конструкція:  

```
#!/usr/bin/env bash  
set -euo pipefail  

# Обробка помилок  
trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR  
```

───────────────────────────────  
🔹 Пояснення  
───────────────────────────────  

- ```#!/usr/bin/env bash```  
  Використовує Bash незалежно від його розташування у системі.  

- ```set -euo pipefail```  
  - -e  : Завершити при першій помилці.  
  - -u  : Заборонити необ’явлені змінні.  
  - -o pipefail: Помилка в конвеєрі = помилка всього блоку.  

- ```trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR```  
  Повідомлення про помилку з номером рядка та завершення скрипта.  

───────────────────────────────  
🔹 Приклад  
───────────────────────────────  

```
#!/usr/bin/env bash  
set -euo pipefail  

# Обробка помилок  
trap 'echo "Сталася помилка на рядку $LINENO"; exit 1' ERR  

mkdir -p /tmp/test  
cp /неіснуючий_файл.txt /tmp/test/  
```

→ Вивід при помилці:  
  ```Сталася помилка на рядку 8```  

───────────────────────────────  
✅ Переваги  
───────────────────────────────  

✓ Уніфікована поведінка скриптів  
✓ Швидке виявлення помилок  
✓ Безпечна робота з конвеєрами та змінними  
✓ Проста діагностика  
✓ Відповідність best practices  

───────────────────────────────  
📌 Примітка  
───────────────────────────────  

Цей шаблон рекомендовано додавати у кожен Bash-скрипт проєкту, незалежно від його функціоналу.

## Перевірка прав на виконання в Bash-скриптах  

Цей шаблон перевірки прав використовується у Bash-скриптах проєкту для забезпечення виконання скрипта з правами суперкористувача (root). Його мета — гарантувати, що скрипт виконується лише за наявності необхідних привілеїв.  

───────────────────────────────  
🔹 Призначення  
───────────────────────────────  

Деякі скрипти потребують прав суперкористувача для виконання певних операцій (наприклад, доступ до системних файлів). Для перевірки прав використовується така конструкція:  

```
if [ "$(id -u)" -ne 0 ]; then  
  echo  
  echo "ВІДМОВА! Недостатньо прав!"  
  echo  
  exit 1  
fi  
```

───────────────────────────────  
🔹 Пояснення  
───────────────────────────────  

- ```id -u```  
  Повертає ідентифікатор користувача (UID). Для суперкористувача (root) UID дорівнює 0.  

- ```[ "$(id -u)" -ne 0 ]```  
  Перевіряє, чи UID користувача не дорівнює 0 (тобто користувач не є root).  

- ```echo "ВІДМОВА! Недостатньо прав!"```  
  Виводить повідомлення про помилку, якщо права недостатні.  

- ```exit 1```  
  Завершує виконання скрипта з кодом помилки 1.  

───────────────────────────────  
🔹 Приклад  
───────────────────────────────  

```
#!/usr/bin/env bash  
set -euo pipefail  

# Перевірка прав на виконання  
if [ "$(id -u)" -ne 0 ]; then  
  echo  
  echo "ВІДМОВА! Недостатньо прав!"  
  echo  
  exit 1  
fi  

# Операції, що потребують прав root  
echo "Виконання операцій з правами суперкористувача..."  
touch /root/test_file  
```

→ Вивід, якщо скрипт виконано без прав root:  
```
ВІДМОВА! Недостатньо прав!
```

───────────────────────────────  
✅ Переваги  
───────────────────────────────  

✓ Гарантія виконання скрипта лише з необхідними правами  
✓ Запобігання непередбаченим помилкам через брак привілеїв  
✓ Чітке повідомлення користувачу про проблему  
✓ Уніфікований підхід до перевірки прав  
✓ Відповідність best practices  

───────────────────────────────  
📌 Примітка  
───────────────────────────────  

Цей шаблон рекомендовано додавати до всіх Bash-скриптів проєкту, які потребують прав суперкористувача, для забезпечення безпеки та коректного виконання.
